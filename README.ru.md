[![en](https://img.shields.io/badge/lang-en-red.svg)](README.md)
[![ru](https://img.shields.io/badge/lang-ru-green.svg)](README.ru.md)
# Skillbox. Дипломная работа "Рекомендательная система для онлайн-гипермаркета Instacart"

В рамках данной дипломной работы была разработана рекомендательная система для онлайн-гипермаркета Instacart в рамках [соревнования](https://www.kaggle.com/competitions/skillbox-recommender-system) на платформе [Kaggle](https://www.kaggle.com/).
При создании системы использовался *гибридный подход*. Рейтинг продуктов пользователя формируется из продуктов, которые он уже покупал, с использованием нескольких методов фильтрации:
- по частоте покупок;
- по времени покупок (количестве дней от даты совершения транзакции до даты совершения последней транзакции);
- по номеру добавления продукта в корзину;
- по популярности продукта (среди всех пользователей).

В рамках обучения модели подбираются *оптимальные* значения коэффициентов трех последних типов фильтрации. *Оптимальным* считается такое значение коэффициента, при котором метрика MAP@10 предсказаний продуктов в последней транзакции на основе предыдущих транзакций принимает максимальное значение.  

В случае, если количество продуктов, которые пользователь покупал, меньше требуемого размера рекомендаций, производится дополнение рекомендаций самыми популярными продуктами из групп, которые его больше всего интересуют.

Обученная модель получила при валидации решения на платформе [Kaggle](https://www.kaggle.com/) получила следующие оценки:
- Private Score - `0.3264`
- Public Score - `0.32822`

Процесс создания модели приведен в [ноутбуке](skillbox_recommender.ipynb). Перед запуском ноутбука необходимо произвести небольшие настройки:
- указать путь к папке проекта, в которой будут размещаться данные (`PROJECT_PATH`, по умолчанию - "D:/skillbox-recommender-system");
- задать количество процессов параллельных вычислений (`WORKERS`, по умолчанию - 4).

Обучение модели на полном наборе транзакций занимает порядка `7,5` минут.
Время формирования списка 10 рекомендованных продуктов составляет примерно:
- `0.23` с - для одного пользователя;
- `23.5` с - для всех пользователей (100000).

### Состав репозитория:
- [skillbox_recommender.ipynb](skillbox_recommender.ipynb) - ноутбук с решением
- [functions.py](functions.py) - библиотека вспомогательных функций
- [multiproc.py](multiproc.py) - скрипт параллельных вычислений
- [average_precision.py](average_precision.py) - [библиотека](https://github.com/benhamner/Metrics/blob/9a637aea795dc6f2333f022b0863398de0a1ca77/Python/ml_metrics/average_precision.py) для расчёта усредненных метрик точности авторства [Wendy Kan](https://github.com/wendykan).
- [kaggle.py](kaggle.py) - библиотека взаимодействия с платформой Kaggle
